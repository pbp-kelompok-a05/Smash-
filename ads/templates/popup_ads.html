{% if popup_ad and popup_ad.image %}
<div id="popup-ads"
     data-delay="{{ popup_ad.popup_delay_seconds|default:3 }}"
     class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 transition-opacity duration-300">
  <div class="relative">
    <button id="close-ads"
            class="absolute -top-3 -right-3 bg-white rounded-full shadow text-gray-600 w-8 h-8 flex items-center justify-center hover:bg-gray-100"
            aria-label="Close">&times;</button>
    {% if popup_ad.link %}
      <a href="{{ popup_ad.link }}" target="_blank" rel="noopener noreferrer">
        <img src="{{ popup_ad.image.url }}" alt="Advertisement"
             class="w-80 sm:w-96 object-cover shadow-lg hover:scale-[1.02] transition-transform">
      </a>
    {% else %}
      <img src="{{ popup_ad.image.url }}" alt="Advertisement"
           class="w-80 sm:w-96 object-cover shadow-lg hover:scale-[1.02] transition-transform">
    {% endif %}
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const popup = document.getElementById('popup-ads');
  if (!popup) return;
  const closeBtn = document.getElementById('close-ads');

  const delayAttr = popup.getAttribute('data-delay') || '3';
  const delay = parseInt(delayAttr, 10) * 1000;

  setTimeout(() => { popup.classList.remove('hidden'); }, Number.isFinite(delay) ? delay : 3000);
  if (closeBtn) closeBtn.addEventListener('click', () => popup.classList.add('hidden'));
  popup.addEventListener('click', (e) => { if (e.target === popup) popup.classList.add('hidden'); });
});
</script>
{% endif %}

